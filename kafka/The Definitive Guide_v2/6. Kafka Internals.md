##  Cluster Membership

- Kafka uses Apache ZooKeeper to maintain the list of brokers that are currently mem‐ bers of a cluster. 
- Every broker has a unique identifier that is either set in the broker configuration file or automatically generated. E
- Every time a broker process starts, it registers itself with its ID in ZooKeeper by creating an [ephemeral node](https://zookeeper.apache.org/doc/r3.4.8/zookeeperProgrammers.html#Ephemeral+Nodes). ephemaral (수명이 짧은, 단명하는)


When a broker loses connectivity to ZooKeeper (usually as a result of the broker stopping, but this can also happen as a result of network partition or a long garbage- collection pause), the ephemeral node that the broker created when starting will be automatically removed from ZooKeeper. 

Kafka components that are watching the list of brokers will be notified that the broker is gone.


-- 이 부분 이해 덜 되었음 --
Even though the node representing the broker is gone when the broker is stopped, the broker ID still exists in other data structures. For example, the list of replicas of each topic  contains the broker IDs for the replica. This way, if you completely lose a broker and start a brand-new broker with the ID of the old one, it will immediately join the cluster in place of the missing broker with the same partitions and topics assigned to it.

## Controller

- The controller is one of the Kafka brokers that, in addition to the usual broker func‐ tionality, is responsible for electing partition leaders.

